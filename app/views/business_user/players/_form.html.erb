<%= form_for @player, url: business_shop_players_action(@player, params[:action]),:html => { :class => '' , multipart: true  } do |f| %>
<% if @player.errors.full_messages.any? %>
  <% @player.errors.full_messages.each do |error_message| %>
  <%= error_message if @player.errors.full_messages.first == error_message %> <br />
  <% end %>
  <% end %>
  <fieldset>
    <div class="form-group">
      <%= f.label :name, :class => 'control-label' %><span class="asterix">*</span>
      <%= f.text_field :name, :class => 'text_field form-control', :placeholder => 'Enter text', :required => '' %>
    </div>    
    <div class="form-group">
      <%= f.label :age, :class => 'control-label' %><span class="asterix">*</span>
      <%= f.text_field :age, :class => 'text_field form-control', :placeholder => 'Enter text', :required => '' %>
    </div>
    <div class="form-group">
      <%= f.label :image, :class => 'control-label' %><span class="asterix">*</span>
      <%= f.file_field :image, :required => '' %>
    </div>
        <div class="form-group">
      <%= f.label :description, :class => 'control-label' %><span class="asterix">*</span>
      <%= f.text_area :description, :class => 'text_field form-control tinymce'  %>
    </div>
    <div class="form-group">
      <%= f.label :baseprice, :class => 'control-label' %><span class="asterix">*</span>
      <%= f.text_field :baseprice, :class => 'text_field form-control', :placeholder => 'Enter text', :required => '' %>
    </div>
    <div class="form-group">
      <table class="table">
        <thead>
          <tr>
            <th>Skills</th>                                 
            <th>Rating</th>
          </tr>
        </thead>
        <tbody>          
          <% if params[:action] == "edit" %>            
            <% index = 0 %>            
            <%= f.fields_for :playerskills do |ps| %>  
              <tr>
                <td>              
                    <div class="collection-check-box">
                      <%= ps.check_box :skill_id, {}, ps.object.player.skills[index].id, '' %> 
                      <%= ps.label :skill_id, ps.object.player.skills[index].name %>   
                      <% if ps.object.player.skills[index].image_url %>                        
                        <%= image_tag ps.object.player.skills[index].image_url(:thumb), :class=> "img-responsive skill-icon"%>
                      <% end %>
                    </div>
                </td>

                <td>
                  <%= ps.text_field :rating %>                  
                </td>
              </tr>              
              <% index = index + 1%>
            <% end %>
          <% else %>       
          
            <% @auction.skills.all.each_with_index do |skill, index| %>            
              <tr>
                <td>              
                    <div class="collection-check-box">
                      
                      <input type="checkbox" value="<%= skill.id %>" name="player[playerskills_attributes][<%=index%>][skill_id]" class=" pull-left" style="margin-right: 10px;">              
                      <% if skill.image_url %>
                        <%= image_tag skill.image_url(:thumb), :class=> "img-responsive skill-icon pull-left",  :style => "height:15px;width:15px;margin-right:5px;"%>
                      <% end %>
                      <%= skill.name %>
                    </div>
                  
                </td>
                <td>
                  <input type="text" name="player[playerskills_attributes][<%=index%>][rating]">              
                </td>
              </tr>
            <% end %>  
          <% end %>        
        </tbody>
      </table>      
      
    </div>
    <input type="hidden" id="auction_id" name="auction_id" value="<%=@auction.id%>">  
    <%= f.submit nil, :class => 'btn btn-primary' %>
    <%= link_to "cancel", business_user_players_path(:auction_id => @auction.id), :class => 'btn btn-default' %>
  </fieldset>
<% end %>
<script type="text/javascript">
  tinyMCE.init({
        selector: "textarea.tinymce",
        toolbar: "styleselect | bold italic | undo redo | table | forecolor | backcolor | emoticons | visualblocks",
        plugins: "table,uploadimage,textcolor,colorpicker,emoticons,hr,textpattern,visualblocks"
      });
</script>
